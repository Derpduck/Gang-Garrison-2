<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event category="OTHER" id="10">
  <actions>
    <action id="603" library="1">
      <!--action name: Code-->
      <kind>CODE</kind>
      <allowRelative>false</allowRelative>
      <question>false</question>
      <canApplyTo>true</canApplyTo>
      <actionType>CODE</actionType>
      <functionName/>
      <relative>false</relative>
      <not>false</not>
      <appliesTo>.self</appliesTo>
      <arguments>
        <argument kind="STRING">if !global.isHost exit;
var message, color;
wincolor = getPlayerColor(sendWinner, true);
losecolor = getPlayerColor(sendLoser, true);
if sendWinner.team==TEAM_RED{
    scoreOrder = string(redScore[sendI])+" - "+string(blueScore[sendI])
}else if sendWinner.team==TEAM_BLUE{
    scoreOrder = string(blueScore[sendI])+" - "+string(redScore[sendI])
}
message = (global.chatPrintPrefix
    +wincolor+c_filter(sendWinner.name)+C_WHITE+" &gt; "+losecolor+c_filter(sendLoser.name)
    +" "+C_GREEN+"("+string(scoreOrder)
    +", Arena "+string(sendI+1)+")")
write_ubyte(global.publicChatBuffer, CHAT_PUBLIC_MESSAGE);
write_ushort(global.publicChatBuffer, string_length(message));
write_string(global.publicChatBuffer, message);
write_byte(global.publicChatBuffer,-1);
print_to_chat(message);

if(sendLoser.object != -1){
    with(sendLoser.object){
        if (!instance_exists(lastDamageDealer) || lastDamageDealer == sendLoser){
            sendEventPlayerDeath(sendLoser, sendLoser, noone, DAMAGE_SOURCE_BID_FAREWELL);
            doEventPlayerDeath(sendLoser, sendLoser, noone, DAMAGE_SOURCE_BID_FAREWELL);
        }else{
            var assistant;
            assistant = secondToLastDamageDealer;
            if (lastDamageDealer.object){
                if (lastDamageDealer.object.healer){
                    assistant = lastDamageDealer.object.healer;
                    sendEventPlayerDeath(player, lastDamageDealer, assistant, DAMAGE_SOURCE_FINISHED_OFF);
                    doEventPlayerDeath(player, lastDamageDealer, assistant, DAMAGE_SOURCE_FINISHED_OFF);
                }
            }
        }
    }
}else if(player.alarm[5]&lt;=0){
    player.alarm[5] = 1;
}

sendLoser.MGE_currentArena=-1
sendLoser.team=TEAM_SPECTATOR
ServerPlayerChangeteam(ds_list_find_index(global.players,sendLoser), sendLoser.team, global.sendBuffer)

redScore[sendI]=0
blueScore[sendI]=0
GameServer.syncTimer=1

sendWinner=-1
sendLoser=-1
sendI=-1
</argument>
      </arguments>
    </action>
  </actions>
</event>
