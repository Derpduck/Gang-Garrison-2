<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event category="STEP" id="2">
  <actions>
    <action id="603" library="1">
      <!--action name: Code-->
      <kind>CODE</kind>
      <allowRelative>false</allowRelative>
      <question>false</question>
      <canApplyTo>true</canApplyTo>
      <actionType>CODE</actionType>
      <functionName/>
      <relative>false</relative>
      <not>false</not>
      <appliesTo>.self</appliesTo>
      <arguments>
        <argument kind="STRING">if (global.myself != -1)
{
    myTeam = global.myself.team;
}

if(global.myself.object != -1)
    instance_destroy();

speed*=0.9
if speed&lt;0.3 speed=0

var moved;
moved = false;
stopTracking = false;

//moving view - mapped keys
if(!(instance_exists(InGameMenuController) || instance_exists(OptionsController) || instance_exists(ControlsController) || instance_exists(HUDOptionsController)))
{
    if keyboard_check(global.left)
    {
        if x &gt; 400 x-=20;
        moved = true;
    }
    else if keyboard_check(global.right)
    {
        if x &lt; map_width()-400 x+=20;
        moved = true;
    }
    
    if keyboard_check(global.jump)
    {
        if y &gt; 300 y-=20;
        moved = true;
    }
    else if keyboard_check(global.down)
    {
        if y &lt; map_height()-300 y+=20;
        moved = true;
    }
}

if(moved)
{
    afktimer = afktimeout;
    stopTracking = true;
}
else if(tracking)
{
    if(instance_exists(player))
    {
        if(player.team != TEAM_SPECTATOR)
        {
            if(player.object)
            {
                if(!(player.object.cloak &amp;&amp; player.team != myTeam))
                {
                    x = round(player.object.x);
                    y = round(player.object.y);
                }
                else
                    stopTracking = true;
            }
        }
        else
            stopTracking = true;
    }
    else
        stopTracking = true;
}

if(tracking and stopTracking) 
{
    tracking = false;
}

if canvasMove{
    if mouse_check_button(mb_left) and cursorUpdate{
        hspeed=0
        vspeed=0
        _x=mouse_x
        _y=mouse_y
        cursorUpdate=false
        moved=true
    }
    if mouse_check_button(mb_left) and !cursorUpdate{
        _px=mouse_x
        _py=mouse_y
        
        _dx=_x-_px
        _dy=_y-_py
        
        x+=other._dx/4
        y+=other._dy/4
        moved=true
    }
    if mouse_check_button_released(mb_left) and !cursorUpdate{
        hspeed=other._dx/4
        vspeed=other._dy/4
        cursorUpdate=true
        moved=true
    }
    if mouse_check_button(mb_right) and cursorUpdate{
        cursorUpdate=false
        hspeed=0
        vspeed=0
        x=mouse_x
        y=mouse_y
        moved=true
    }
    if mouse_check_button_released(mb_right) and !cursorUpdate{
        cursorUpdate=true
        moved=true
    }
}

// Clip view to map area
// We want a different area depending on whether we're tracking a player or not.
if(!tracking)
{
    x = max(view_wview/2, min(map_width()-view_wview/2, x));
    y = max(view_hview/2, min(map_height()-view_hview/2, y));
}
else // We're tracking a player, so allow the view to show area from off of the map
{
    x = max(0, min(map_width(), x));
    y = max(0, min(map_height(), y));
}
view_xview = x-view_wview/2;
view_yview = y-view_hview/2;

afktimer-=1;

if((afktimer&lt;=0) and global.isHost==false)
{
    show_message("You have been disconnected from the server. Reason: AFK");
    with(Client)
        instance_destroy();
}
</argument>
      </arguments>
    </action>
  </actions>
</event>
